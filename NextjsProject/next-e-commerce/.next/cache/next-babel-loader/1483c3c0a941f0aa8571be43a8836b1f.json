{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport React, { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { yupResolver } from \"@hookform/resolvers/yup\";\nimport * as yup from \"yup\";\nimport { useAuth } from \"@/firebase/context\";\nimport styles from \"./account.module.scss\";\nimport AccountSidebar from \"@/components/AccountSidebar\";\nimport Layout from \"@/components/Layout\";\nimport Input from \"@/components/Input\";\nimport Button from \"@/components/Button\";\nimport { updateUser, updatePassword } from \"@/firebase/update-user\";\nimport { useRouter } from \"next/router\";\nconst schema = yup.object().shape({\n  name: yup.string().required(\"* Name is required.\").min(2, \"* Name is too short\"),\n  surname: yup.string().required(\"* Surname is required.\").min(2, \"* Surname is too short\"),\n  email: yup.string().email().required(\"* Email is required.\"),\n  phone: yup.string().notRequired().matches(/^[+]*[(]{0,1}[0-9]{1,4}[)]{0,1}[-\\s\\./0-9]*$/g, {\n    message: \"Invalid Phone Number\",\n    excludeEmptyString: true\n  })\n});\nconst schema2 = yup.object().shape({\n  currentPassword: yup.string().required(\"* Current Password is required.\").min(8, \"* Password is too short - should be 8 chars minimum.\"),\n  newPassword: yup.string().required(\"* New Password is required.\").min(8, \"* Password is too short - should be 8 chars minimum.\"),\n  confirmPassword: yup.string().oneOf([yup.ref(\"newPassword\"), null], \"Passwords must match\")\n});\nexport default function AccountPage() {\n  const {\n    0: passwordError,\n    1: setError\n  } = useState(null);\n  const {\n    0: photo,\n    1: setPhoto\n  } = useState(null);\n  const {\n    user,\n    loading\n  } = useAuth();\n  const {\n    register,\n    handleSubmit,\n    watch,\n    errors\n  } = useForm({\n    resolver: yupResolver(schema)\n  });\n  const {\n    register: register2,\n    handleSubmit: handleSubmit2,\n    errors: errors2,\n    getValues\n  } = useForm({\n    resolver: yupResolver(schema2)\n  });\n\n  const onSubmit = ({\n    email,\n    phone,\n    name,\n    surname\n  }) => {\n    updateUser({\n      email,\n      phone,\n      name,\n      surname,\n      photo,\n      finalEvent: () => window.location.reload(false)\n    });\n  };\n\n  const changePassword = ({\n    currentPassword,\n    newPassword\n  }) => {\n    const {\n      reauth,\n      update\n    } = updatePassword({\n      currentPassword,\n      newPassword\n    });\n    reauth().then(() => update().then(() => setError(\"Password Changed!\")).catch(e => setError(e.message))).catch(e => setError(e.message));\n  };\n\n  if (!user && !loading) useRouter().push(\"/login\");\n  return /*#__PURE__*/_jsxs(Layout, {\n    noCategories: true,\n    children: [/*#__PURE__*/_jsx(AccountSidebar, {}), /*#__PURE__*/_jsxs(\"main\", {\n      className: styles.container,\n      children: [/*#__PURE__*/_jsx(\"h1\", {\n        className: styles.title,\n        children: \"My Account\"\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: styles.content,\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: styles.accountContainer,\n          children: [/*#__PURE__*/_jsx(\"h4\", {\n            children: \"Account Details\"\n          }), /*#__PURE__*/_jsxs(\"form\", {\n            onSubmit: handleSubmit(onSubmit),\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: styles.inputContainer,\n              children: [/*#__PURE__*/_jsx(\"span\", {\n                children: \"Name\"\n              }), /*#__PURE__*/_jsx(Input, {\n                name: \"name\",\n                defaultValue: user === null || user === void 0 ? void 0 : user.name,\n                noMargin: true,\n                register: register,\n                placeholder: \"Name\",\n                error: errors.name\n              })]\n            }), errors.name && /*#__PURE__*/_jsx(\"span\", {\n              style: {\n                color: \"red\",\n                marginTop: 4,\n                fontSize: 14\n              },\n              children: errors.name.message\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: styles.inputContainer,\n              children: [/*#__PURE__*/_jsx(\"span\", {\n                children: \"Surname\"\n              }), /*#__PURE__*/_jsx(Input, {\n                name: \"surname\",\n                defaultValue: user === null || user === void 0 ? void 0 : user.surname,\n                noMargin: true,\n                register: register,\n                placeholder: \"Surname\",\n                error: errors.surname\n              })]\n            }), errors.surname && /*#__PURE__*/_jsx(\"span\", {\n              style: {\n                color: \"red\",\n                marginTop: 4,\n                fontSize: 14\n              },\n              children: errors.surname.message\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: styles.inputContainer,\n              children: [/*#__PURE__*/_jsx(\"span\", {\n                children: \"Email\"\n              }), /*#__PURE__*/_jsx(Input, {\n                name: \"email\",\n                defaultValue: user === null || user === void 0 ? void 0 : user.email,\n                noMargin: true,\n                register: register,\n                placeholder: \"E-mail\",\n                error: errors.email\n              })]\n            }), errors.email && /*#__PURE__*/_jsx(\"span\", {\n              style: {\n                color: \"red\",\n                marginTop: 4,\n                fontSize: 14\n              },\n              children: errors.email.message\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: styles.inputContainer,\n              children: [/*#__PURE__*/_jsx(\"span\", {\n                children: \"Phone Number\"\n              }), /*#__PURE__*/_jsx(Input, {\n                name: \"phone\",\n                defaultValue: user === null || user === void 0 ? void 0 : user.phoneNumber,\n                noMargin: true,\n                register: register,\n                error: errors.phone\n              })]\n            }), errors.phone && /*#__PURE__*/_jsx(\"span\", {\n              style: {\n                color: \"red\",\n                marginTop: 4,\n                fontSize: 14\n              },\n              children: errors.phone.message\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: styles.inputContainer,\n              children: [/*#__PURE__*/_jsx(\"span\", {\n                children: \"Profile Photo\"\n              }), /*#__PURE__*/_jsxs(\"label\", {\n                className: styles.uploadButton,\n                children: [/*#__PURE__*/_jsx(\"input\", {\n                  type: \"file\",\n                  onChange: e => setPhoto(e.target.files[0]),\n                  accept: \"image/*\",\n                  style: {\n                    display: \"none\"\n                  }\n                }), (photo === null || photo === void 0 ? void 0 : photo.name) || \"Select File\"]\n              })]\n            }), /*#__PURE__*/_jsx(Button, {\n              type: \"submit\",\n              name: \"update_button\",\n              value: \"Update\",\n              children: \"Update\"\n            })]\n          }, \"account-form\")]\n        }), /*#__PURE__*/_jsx(\"hr\", {}), /*#__PURE__*/_jsxs(\"div\", {\n          className: styles.passwordContainer,\n          children: [/*#__PURE__*/_jsx(\"h4\", {\n            children: \"Change Password\"\n          }), /*#__PURE__*/_jsxs(\"form\", {\n            onSubmit: handleSubmit2(changePassword),\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: styles.inputContainer,\n              children: [/*#__PURE__*/_jsx(\"span\", {\n                children: \"Current Password\"\n              }), /*#__PURE__*/_jsx(Input, {\n                name: \"currentPassword\",\n                register: register2,\n                placeholder: \"Current Password\",\n                noMargin: true\n              })]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: styles.inputContainer,\n              children: [/*#__PURE__*/_jsx(\"span\", {\n                children: \"New Password\"\n              }), /*#__PURE__*/_jsx(Input, {\n                name: \"newPassword\",\n                register: register2,\n                placeholder: \"New Password\",\n                noMargin: true\n              })]\n            }), errors2.newPassword && /*#__PURE__*/_jsx(\"span\", {\n              style: {\n                color: \"red\",\n                marginTop: 4,\n                fontSize: 14\n              },\n              children: errors2.newPassword.message\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: styles.inputContainer,\n              children: [/*#__PURE__*/_jsx(\"span\", {\n                children: \"Confirm New Password\"\n              }), /*#__PURE__*/_jsx(Input, {\n                name: \"confirmPassword\",\n                register: register2,\n                placeholder: \"Confirm New Password\",\n                noMargin: true\n              })]\n            }), errors2.confirmPassword && /*#__PURE__*/_jsx(\"span\", {\n              style: {\n                color: \"red\",\n                marginTop: 4,\n                fontSize: 14\n              },\n              children: errors2.confirmPassword.message\n            }), passwordError && /*#__PURE__*/_jsx(\"span\", {\n              style: {\n                color: passwordError === \"Password Changed!\" ? \"black\" : \"red\",\n                marginTop: 4,\n                fontSize: 14\n              },\n              children: passwordError\n            }), /*#__PURE__*/_jsx(Button, {\n              type: \"submit\",\n              name: \"password_button\",\n              value: \"Change Password\",\n              children: \"Confirm\"\n            })]\n          }, \"password-form\")]\n        })]\n      })]\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}